# 技能图标优先级说明

## 图标字段说明

### 1. `SkillNodeData.Icon`（技能数据中的图标）
- **位置**：`SkillNodeData` ScriptableObject 资产
- **用途**：技能的默认图标
- **使用场景**：所有未满级状态的技能都使用此图标

### 2. `SkillSlotUI.maxLevelIconSprite`（技能槽中的满级图标）
- **位置**：`SkillSlotUI` 组件（在技能槽 GameObject 上）
- **用途**：技能满级时的特殊图标（可选）
- **使用场景**：仅当技能达到最大等级时使用

## 优先级关系

### 未满级状态（优先级：`SkillNodeData.Icon`）

当技能**未达到最大等级**时：
- **始终使用** `SkillNodeData.Icon`
- `SkillSlotUI.maxLevelIconSprite` **不会生效**
- 无论是否设置了 `maxLevelIconSprite`，都会显示 `SkillNodeData.Icon`

### 满级状态（优先级：`SkillSlotUI.maxLevelIconSprite` > `SkillNodeData.Icon`）

当技能**达到最大等级**时：
- **如果设置了** `SkillSlotUI.maxLevelIconSprite`：
  - 使用 `maxLevelIconSprite`（优先级高）
  - 颜色设置为白色，显示 Sprite 的原始颜色
- **如果没有设置** `SkillSlotUI.maxLevelIconSprite`：
  - 使用 `SkillNodeData.Icon`（回退）
  - 颜色设置为绿色（`unlockedColor`），通过颜色变化标识满级

## 代码逻辑流程

```
初始化 (InitializeDisplay)
  ↓
使用 SkillNodeData.Icon 作为初始图标
  ↓
状态更新 (UpdateUIState)
  ↓
检查技能等级
  ↓
┌─────────────────┬─────────────────┐
│   未满级        │     满级         │
│                 │                 │
│ 使用 Icon       │ 检查 maxLevelIconSprite │
│ (始终)          │                 │
│                 │  ┌──────────────┴──────┐
│                 │  │ 已设置？            │
│                 │  │                     │
│                 │  │ 是 → 使用 maxLevelIconSprite │
│                 │  │ 否 → 使用 Icon + 绿色 │
│                 │  └─────────────────────┘
└─────────────────┴─────────────────┘
```

## 替换图标指南

### 场景 1：替换普通状态的图标（未满级时显示）

**修改位置**：`SkillNodeData` ScriptableObject 资产

**步骤**：
1. 在 Project 窗口中找到对应的 `SkillNodeData` 资产
2. 在 Inspector 中查看该资产
3. 找到 "Icon" 字段
4. 将新的图标 Sprite 拖入此字段
5. 保存资产

**影响范围**：
- 所有使用此 `SkillNodeData` 的技能槽都会更新
- 未满级时显示新图标
- 如果未设置 `maxLevelIconSprite`，满级时也会显示新图标（但会变绿色）

### 场景 2：替换满级状态的图标（满级时显示）

**修改位置**：`SkillSlotUI` 组件（在技能槽 GameObject 上）

**步骤**：
1. 在 Hierarchy 中找到对应的技能槽 GameObject
2. 在 Inspector 中查看 `SkillSlotUI` 组件
3. 展开 "图标配置" 部分
4. 找到 "Max Level Icon Sprite" 字段
5. 将满级图标 Sprite 拖入此字段
6. 如果修改的是预制体实例，点击 "Apply" 保存

**影响范围**：
- 仅影响当前技能槽
- 满级时显示满级图标
- 未满级时仍显示 `SkillNodeData.Icon`

### 场景 3：同时替换普通和满级图标

**步骤**：
1. 先修改 `SkillNodeData.Icon`（普通图标）
2. 再修改 `SkillSlotUI.maxLevelIconSprite`（满级图标）

**结果**：
- 未满级时显示普通图标
- 满级时显示满级图标

## 实际使用建议

### 推荐配置方式

1. **统一管理普通图标**：
   - 在 `SkillNodeData` 中设置所有技能的普通图标
   - 这样所有技能槽都会自动使用相同的图标

2. **个性化满级图标**：
   - 如果需要，在 `SkillSlotUI` 中为特定技能设置满级图标
   - 这样可以为不同的技能设计不同的满级效果

3. **批量替换**：
   - 如果要替换所有技能的普通图标，修改 `SkillNodeData` 资产
   - 如果要替换所有技能的满级图标，需要为每个技能槽单独设置

## 常见问题

### Q1: 我修改了 `SkillNodeData.Icon`，但满级时没有变化？

**A**: 这是正常的。如果设置了 `SkillSlotUI.maxLevelIconSprite`，满级时会优先使用满级图标。要看到 `SkillNodeData.Icon` 在满级时的效果，需要：
- 清空 `SkillSlotUI.maxLevelIconSprite` 字段，或
- 在 `SkillNodeData.Icon` 中设置满级图标

### Q2: 我修改了 `SkillSlotUI.maxLevelIconSprite`，但未满级时没有变化？

**A**: 这是正常的。`maxLevelIconSprite` 只在满级时生效。未满级时始终使用 `SkillNodeData.Icon`。

### Q3: 我应该修改哪个字段来替换图标？

**A**: 取决于你的需求：
- **替换普通图标**：修改 `SkillNodeData.Icon`
- **替换满级图标**：修改 `SkillSlotUI.maxLevelIconSprite`
- **同时替换**：两个都修改

### Q4: 优先级总结

**未满级时**：
- `SkillNodeData.Icon` ✅（唯一使用）

**满级时**：
- `SkillSlotUI.maxLevelIconSprite` ✅（如果设置，优先级最高）
- `SkillNodeData.Icon` ✅（如果未设置 `maxLevelIconSprite`，作为回退）

## 相关文件

- `Assets/Scripts/UI/SkillSlotUI.cs`：技能槽 UI 脚本
- `Assets/Scripts/Systems/SkillTree/SkillNodeData.cs`：技能数据脚本

