# 技能效果值（EffectValue）汇总说明

## 概述

本文档详细说明所有技能效果类型中 `EffectValue` 字段的填写方式和数值作用机制。

## 重要说明

### EffectValue 的作用方式
- **累加机制**：每次升级时，`EffectValue` 会**累加**到当前属性值上
- **每级独立**：每个等级的 `EffectValue` 是独立的增量，不是总数值
- **示例**：如果第1级 `EffectValue = 5`，第2级 `EffectValue = 3`，则总提升 = 5 + 3 = 8

### 初始值参考
在 `UpgradeManager` 中定义的初始值：
- 攻击力：`10`
- 攻击范围：`2`
- 攻击间隔：`1` 秒
- 回合时间：`60` 秒
- 恢复几率：`0.5` (50%)
- 金鸡生成率：`0.05` (5%)
- 金蛋价值倍率：`5`
- 产蛋时间延长概率：`0.01` (1%)

---

## 技能效果类型详细说明

### 1. AttackDamage（攻击力提升）

**效果值类型**：`float`（浮点数）

**作用方式**：
```csharp
currentDamage += value;
```

**填写说明**：
- 直接填写**增加的攻击力数值**
- 例如：填写 `5` 表示攻击力 +5
- 例如：填写 `2.5` 表示攻击力 +2.5

**初始值**：`10`

**示例**：
- 第1级 `EffectValue = 5` → 攻击力变为 15
- 第2级 `EffectValue = 3` → 攻击力变为 18
- 第3级 `EffectValue = 2` → 攻击力变为 20

---

### 2. AttackRadius（攻击范围提升）

**效果值类型**：`float`（浮点数）

**作用方式**：
```csharp
currentRadius += value;
```

**填写说明**：
- 直接填写**增加的攻击范围数值**（世界单位）
- 例如：填写 `0.5` 表示攻击范围 +0.5
- 例如：填写 `1` 表示攻击范围 +1

**初始值**：`2`

**示例**：
- 第1级 `EffectValue = 0.5` → 攻击范围变为 2.5
- 第2级 `EffectValue = 0.5` → 攻击范围变为 3.0
- 第3级 `EffectValue = 1` → 攻击范围变为 4.0

---

### 3. AttackSpeed（攻击速度提升）

**效果值类型**：`float`（浮点数，**注意：应该是负数**）

**作用方式**：
```csharp
currentAttackInterval = Mathf.Max(0.1f, currentAttackInterval + value);
// 最小间隔限制为 0.1 秒
```

**填写说明**：
- **填写负数**来减少攻击间隔（提升攻击速度）
- 例如：填写 `-0.1` 表示攻击间隔减少 0.1 秒
- 例如：填写 `-0.2` 表示攻击间隔减少 0.2 秒
- **注意**：攻击间隔最小为 0.1 秒，无法继续减少

**初始值**：`1` 秒

**示例**：
- 第1级 `EffectValue = -0.1` → 攻击间隔变为 0.9 秒
- 第2级 `EffectValue = -0.1` → 攻击间隔变为 0.8 秒
- 第3级 `EffectValue = -0.2` → 攻击间隔变为 0.6 秒

---

### 4. SessionDuration（回合时间提升）

**效果值类型**：`float`（浮点数）

**作用方式**：
```csharp
currentSessionDuration += value;
```

**填写说明**：
- 直接填写**增加的回合时间**（秒）
- 例如：填写 `10` 表示回合时间 +10 秒
- 例如：填写 `5.5` 表示回合时间 +5.5 秒

**初始值**：`60` 秒

**示例**：
- 第1级 `EffectValue = 10` → 回合时间变为 70 秒
- 第2级 `EffectValue = 10` → 回合时间变为 80 秒
- 第3级 `EffectValue = 15` → 回合时间变为 95 秒

---

### 5. MoveSpeed（移动速度提升）

**效果值类型**：`float`（浮点数）

**作用方式**：
```csharp
// 预留功能，当前未实现
Debug.Log($"UpgradeManager: 移动速度提升 {value}（功能预留）", this);
```

**填写说明**：
- 当前为预留功能，填写数值不会生效
- 未来可能用于提升玩家移动速度

---

### 6. RecoveryChance（恢复几率提升）

**效果值类型**：`float`（浮点数，范围 0-1）

**作用方式**：
```csharp
recoveryChance = Mathf.Clamp01(recoveryChance + value);
// 限制在 0-1 之间
```

**填写说明**：
- 填写**增加的恢复几率**（0-1 之间的小数）
- 例如：填写 `0.1` 表示恢复几率 +10%
- 例如：填写 `0.05` 表示恢复几率 +5%
- **注意**：最终值会被限制在 0-1 之间（0%-100%）

**初始值**：`0.5` (50%)

**示例**：
- 第1级 `EffectValue = 0.1` → 恢复几率变为 60%
- 第2级 `EffectValue = 0.1` → 恢复几率变为 70%
- 第3级 `EffectValue = 0.2` → 恢复几率变为 90%

---

### 7. UnlockMitosis（解锁分裂能力）

**效果值类型**：`float`（**value 被忽略**）

**作用方式**：
```csharp
isMitosisUnlocked = true;
// value 参数被忽略
```

**填写说明**：
- **EffectValue 字段可以填写任意值，但会被忽略**
- 只要升级此技能，就会解锁分裂能力
- 建议填写 `1` 或 `0` 作为占位符

**注意**：这是一个**解锁类技能**，不是数值提升类技能

---

### 8. MitosisChance（分裂几率提升）

**效果值类型**：`float`（浮点数，范围 0-1）

**作用方式**：
```csharp
mitosisChance = Mathf.Clamp01(mitosisChance + value);
// 限制在 0-1 之间
```

**填写说明**：
- 填写**增加的分裂几率**（0-1 之间的小数）
- 例如：填写 `0.1` 表示分裂几率 +10%
- 例如：填写 `0.05` 表示分裂几率 +5%
- **注意**：最终值会被限制在 0-1 之间（0%-100%）

**初始值**：`0` (0%，需要先解锁分裂能力)

**示例**：
- 第1级 `EffectValue = 0.1` → 分裂几率变为 10%
- 第2级 `EffectValue = 0.1` → 分裂几率变为 20%
- 第3级 `EffectValue = 0.15` → 分裂几率变为 35%

---

### 9. MaxChickenCount（最大鸡数量提升）

**效果值类型**：`float`（浮点数，会四舍五入为整数）

**作用方式**：
```csharp
extraMaxChickens += Mathf.RoundToInt(value);
// 四舍五入为整数
```

**填写说明**：
- 填写**增加的最大鸡数量**
- 例如：填写 `5` 表示最大鸡数量 +5
- 例如：填写 `3.7` 会被四舍五入为 4
- **注意**：最终会转换为整数

**初始值**：`0`（额外数量）

**示例**：
- 第1级 `EffectValue = 5` → 额外最大鸡数量 +5
- 第2级 `EffectValue = 3` → 额外最大鸡数量 +8
- 第3级 `EffectValue = 2` → 额外最大鸡数量 +10

---

### 10. InitialChickenCount（初始鸡数量提升）

**效果值类型**：`float`（浮点数，会四舍五入为整数）

**作用方式**：
```csharp
extraInitialChickens += Mathf.RoundToInt(value);
// 四舍五入为整数
```

**填写说明**：
- 填写**增加的初始鸡数量**（回合开始时生成的额外数量）
- 例如：填写 `3` 表示初始鸡数量 +3
- 例如：填写 `2.5` 会被四舍五入为 3
- **注意**：最终会转换为整数

**初始值**：`0`（额外数量）

**示例**：
- 第1级 `EffectValue = 3` → 额外初始鸡数量 +3
- 第2级 `EffectValue = 2` → 额外初始鸡数量 +5
- 第3级 `EffectValue = 1` → 额外初始鸡数量 +6

---

### 11. GoldenChickenSpawnRate（金鸡生成率提升）

**效果值类型**：`float`（浮点数，范围 0-1）

**作用方式**：
```csharp
goldenChickenSpawnRate = Mathf.Clamp01(goldenChickenSpawnRate + value);
// 限制在 0-1 之间
```

**填写说明**：
- 填写**增加的金鸡生成率**（0-1 之间的小数）
- 例如：填写 `0.05` 表示金鸡生成率 +5%
- 例如：填写 `0.1` 表示金鸡生成率 +10%
- **注意**：最终值会被限制在 0-1 之间（0%-100%）

**初始值**：`0.05` (5%)

**示例**：
- 第1级 `EffectValue = 0.05` → 金鸡生成率变为 10%
- 第2级 `EffectValue = 0.05` → 金鸡生成率变为 15%
- 第3级 `EffectValue = 0.1` → 金鸡生成率变为 25%

---

### 12. GoldenEggMultiplier（金蛋价值倍率提升）

**效果值类型**：`float`（浮点数，会四舍五入为整数）

**作用方式**：
```csharp
goldenEggMultiplier += Mathf.RoundToInt(value);
// 四舍五入为整数
```

**填写说明**：
- 填写**增加的金蛋价值倍率**
- 例如：填写 `2` 表示金蛋价值倍率 +2
- 例如：填写 `1.5` 会被四舍五入为 2
- **注意**：最终会转换为整数

**初始值**：`5`（1 个金蛋 = 5 个普通蛋）

**示例**：
- 第1级 `EffectValue = 2` → 金蛋价值倍率变为 7
- 第2级 `EffectValue = 2` → 金蛋价值倍率变为 9
- 第3级 `EffectValue = 3` → 金蛋价值倍率变为 12

---

### 13. CritChance（暴击率提升）

**效果值类型**：`float`（浮点数，范围 0-1）

**作用方式**：
```csharp
critChance = Mathf.Clamp01(critChance + value);
// 限制在 0-1 之间
```

**填写说明**：
- 填写**增加的暴击率**（0-1 之间的小数）
- 例如：填写 `0.1` 表示暴击率 +10%
- 例如：填写 `0.05` 表示暴击率 +5%
- **注意**：最终值会被限制在 0-1 之间（0%-100%）

**初始值**：`0` (0%)

**示例**：
- 第1级 `EffectValue = 0.1` → 暴击率变为 10%
- 第2级 `EffectValue = 0.1` → 暴击率变为 20%
- 第3级 `EffectValue = 0.15` → 暴击率变为 35%

---

### 14. UnlockDoubleProduction（解锁双倍产出能力）

**效果值类型**：`float`（**value 被忽略**）

**作用方式**：
```csharp
isDoubleProductionUnlocked = true;
// value 参数被忽略
```

**填写说明**：
- **EffectValue 字段可以填写任意值，但会被忽略**
- 只要升级此技能，就会解锁双倍产出能力
- 建议填写 `1` 或 `0` 作为占位符

**注意**：这是一个**解锁类技能**，不是数值提升类技能

---

### 15. DoubleProductionChance（双倍产出概率提升）

**效果值类型**：`float`（浮点数，范围 0-1）

**作用方式**：
```csharp
doubleProductionChance = Mathf.Clamp01(doubleProductionChance + value);
// 限制在 0-1 之间
```

**填写说明**：
- 填写**增加的双倍产出概率**（0-1 之间的小数）
- 例如：填写 `0.1` 表示双倍产出概率 +10%
- 例如：填写 `0.05` 表示双倍产出概率 +5%
- **注意**：最终值会被限制在 0-1 之间（0%-100%）
- **前提**：需要先解锁 `UnlockDoubleProduction` 技能

**初始值**：`0` (0%，需要先解锁双倍产出能力)

**示例**：
- 第1级 `EffectValue = 0.1` → 双倍产出概率变为 10%
- 第2级 `EffectValue = 0.1` → 双倍产出概率变为 20%
- 第3级 `EffectValue = 0.15` → 双倍产出概率变为 35%

---

### 16. UnlockGravityWave（解锁引力波能力）

**效果值类型**：`float`（**value 被忽略**）

**作用方式**：
```csharp
isGravityWaveUnlocked = true;
// value 参数被忽略
```

**填写说明**：
- **EffectValue 字段可以填写任意值，但会被忽略**
- 只要升级此技能，就会解锁引力波能力
- 建议填写 `1` 或 `0` 作为占位符

**注意**：这是一个**解锁类技能**，不是数值提升类技能。需要先解锁此技能，才能使用 `GravityWaveChance` 技能来提升引力波概率。

**引力波效果**：
- 鸡生蛋时，有概率（初始1%，可通过 `GravityWaveChance` 技能升级）让回合时间增加 0.2 秒（固定值，可在代码中配置）

---

### 17. GravityWaveChance（引力波概率提升）

**效果值类型**：`float`（浮点数，范围 0-1）

**作用方式**：
```csharp
gravityWaveChance = Mathf.Clamp01(gravityWaveChance + value);
// 限制在 0-1 之间
```

**填写说明**：
- 填写**增加的引力波触发概率**（0-1 之间的小数）
- 例如：填写 `0.05` 表示引力波概率 +5%
- 例如：填写 `0.1` 表示引力波概率 +10%
- **注意**：最终值会被限制在 0-1 之间（0%-100%）
- **效果**：提升鸡生蛋时触发引力波的概率
- **前提**：需要先解锁 `UnlockGravityWave` 技能，否则此技能无效

**初始值**：`0.01` (1%)

**示例**：
- 第1级 `EffectValue = 0.05` → 引力波概率变为 6%
- 第2级 `EffectValue = 0.05` → 引力波概率变为 11%
- 第3级 `EffectValue = 0.1` → 引力波概率变为 21%

**重要说明**：
- 引力波效果：鸡生蛋时，有该概率让回合时间增加 0.2 秒（固定值）
- 如果未解锁 `UnlockGravityWave`，引力波效果**不会生效**
- 如果已解锁 `UnlockGravityWave`：
  - 每次鸡生蛋时，根据 `GravityWaveChance` 的概率值判断是否触发引力波
  - 如果触发，回合时间增加 0.2 秒（固定值，可在代码中配置）

---

## 效果值类型总结表

| 技能效果类型 | 效果值类型 | 作用方式 | 初始值 | 限制/转换 |
|------------|-----------|---------|--------|----------|
| AttackDamage | float | 直接累加 | 10 | 无限制 |
| AttackRadius | float | 直接累加 | 2 | 无限制 |
| AttackSpeed | float | 累加（**负数**） | 1秒 | 最小0.1秒 |
| SessionDuration | float | 直接累加 | 60秒 | 无限制 |
| MoveSpeed | float | 预留（未实现） | - | - |
| RecoveryChance | float | 累加并限制 | 0.5 (50%) | 0-1 (0%-100%) |
| UnlockMitosis | float | **忽略**（解锁） | false | - |
| MitosisChance | float | 累加并限制 | 0 (0%) | 0-1 (0%-100%) |
| MaxChickenCount | float | 累加并四舍五入 | 0 | 转换为整数 |
| InitialChickenCount | float | 累加并四舍五入 | 0 | 转换为整数 |
| GoldenChickenSpawnRate | float | 累加并限制 | 0.05 (5%) | 0-1 (0%-100%) |
| GoldenEggMultiplier | float | 累加并四舍五入 | 5 | 转换为整数 |
| CritChance | float | 累加并限制 | 0 (0%) | 0-1 (0%-100%) |
| UnlockDoubleProduction | float | **忽略**（解锁） | false | - |
| DoubleProductionChance | float | 累加并限制 | 0 (0%) | 0-1 (0%-100%) |
| UnlockGravityWave | float | **忽略**（解锁） | false | - |
| GravityWaveChance | float | 累加并限制 | 0.01 (1%) | 0-1 (0%-100%) | 提升鸡生蛋时触发引力波的概率 |

---

## 填写建议

### 1. 直接累加类型（无限制）
- **AttackDamage**、**AttackRadius**、**SessionDuration**
- 可以填写任意正数
- 建议根据游戏平衡性设置合理的增量

### 2. 概率类型（0-1 范围）
- **RecoveryChance**、**MitosisChance**、**GoldenChickenSpawnRate**、**CritChance**、**DoubleProductionChance**、**GravityWaveChance**
- 填写 0-1 之间的小数
- 例如：`0.1` = 10%，`0.05` = 5%，`0.01` = 1%
- **注意**：系统会自动限制在 0-1 之间，超过 1 会被限制为 1

### 3. 整数类型（四舍五入）
- **MaxChickenCount**、**InitialChickenCount**、**GoldenEggMultiplier**
- 可以填写小数，但会被四舍五入为整数
- 建议直接填写整数

### 4. 特殊类型
- **AttackSpeed**：填写**负数**来减少攻击间隔
  - 例如：`-0.1` 表示减少 0.1 秒
  - 最小间隔限制为 0.1 秒
- **UnlockMitosis**、**UnlockDoubleProduction**、**UnlockGravityWave**：解锁类技能，EffectValue 会被忽略
- **GravityWaveChance**：提升鸡生蛋时触发引力波的概率，引力波触发时回合时间增加0.2秒（固定值，需要先解锁 `UnlockGravityWave` 才能生效）

---

## 常见问题

### Q1: 为什么我的概率技能填写 0.5 后，概率变成了 50%？

**A**: 这是正常的。概率值使用 0-1 的小数表示：
- `0.5` = 50%
- `0.1` = 10%
- `1.0` = 100%

### Q2: 为什么 AttackSpeed 要填写负数？

**A**: 因为攻击速度提升是通过**减少攻击间隔**实现的。填写负数（如 `-0.1`）会减少间隔，从而提升攻击速度。

### Q3: 如果概率值累加超过 1 会怎样？

**A**: 系统会自动使用 `Mathf.Clamp01()` 将值限制在 0-1 之间。超过 1 的值会被限制为 1（100%）。

### Q4: 为什么有些技能的效果值会被忽略？

**A**: 解锁类技能（`UnlockMitosis`、`UnlockDoubleProduction`）只需要触发解锁，不需要数值，所以 EffectValue 会被忽略。

### Q5: 如何计算总效果值？

**A**: 总效果值 = 所有等级的 EffectValue 累加。例如：
- 第1级：EffectValue = 5
- 第2级：EffectValue = 3
- 第3级：EffectValue = 2
- **总提升** = 5 + 3 + 2 = 10

---

## 相关文件

- `Assets/Scripts/Systems/SkillTree/SkillNodeData.cs`：技能数据定义
- `Assets/Scripts/Core/UpgradeManager.cs`：升级管理器（应用效果值）

